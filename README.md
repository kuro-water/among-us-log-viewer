# 🎮 Among Us ゲーム履歴ビューワー

シンプルで高速なゲーム履歴分析ダッシュボード。インストール不要、ブラウザだけで動作します。<br>
⚠️ **KTR（身内）向けなので、一般的な among us 環境では動作しません。**

## ✨ 主な機能

### 📊 データ分析

-   **ランキング** - 勝利数ランキングと勝率ランキング（3 ゲーム以上）を円グラフで可視化
-   **プレイヤー統計** - 全プレイヤーの詳細な勝率、生存率、ロール別勝率を表示（カスタムロール対応）
-   **ロール別勝率分析** - すべてのロール別の勝率を分析（MOD カスタムロール対応）
-   **ゲーム一覧** - 全ゲームの詳細情報を表形式で表示

### 🎨 UI 特性

-   ✅ **ダークテーマ** - Among Us のビジュアルに合わせた赤 × 水色配色
-   ✅ **レスポンシブデザイン** - スマートフォンからタブレット、デスクトップまで対応
-   ✅ **複数ファイル構成** - HTML、CSS、JavaScript を分割し保守性向上
-   ✅ **オフライン対応** - インターネット接続不要（CDN は最初の読み込みのみ）
-   ✅ **MOD 対応** - カスタムロール自動検出・表示

## 🚀 使用方法

### 推奨方法：ワンクリック起動

1. `start-server.bat` をダブルクリック
2. 自動的に Chrome が起動し、`http://localhost:8000` が開きます
3. `game_history.jsonl` が自動的に読み込まれます

### 手動方法：ローカルサーバーで実行

```bash
# Python 3
python -m http.server 8000

# または Node.js
npx http-server
```

その後、ブラウザで `http://localhost:8000` にアクセス

### ファイル読み込み方法

ファイル自動読み込み（推奨）:

-   同じフォルダに `game_history.jsonl` を配置しておくと、サーバー起動時に自動で読み込まれます

手動読み込み:

1. **ドラッグ&ドロップ**: `game_history.jsonl` を「📤 アップロードゾーン」にドラッグ&ドロップ
2. **ファイル選択**: 「ファイルを選択」ボタンをクリック

ファイル読み込み後、以下のタブで分析を確認できます：

| タブ              | 説明                           |
| ----------------- | ------------------------------ |
| 📊 概要           | 勝利数と勝率のランキング       |
| 🎮 プレイヤー統計 | 全プレイヤーの詳細成績表       |
| 🎯 ロール分析     | ロール別勝率（円グラフ）       |
| 📋 ゲーム一覧     | 全ゲームのログ表               |

### フィルタリング機能

-   **開始日時/終了日時**: 手動で日付範囲を指定
-   **直近〇〇の選択**: プリセットボタンで素早くフィルタリング
    -   直近 3/6/12/24 時間
    -   直近 2〜7 日
    -   直近 30 日
-   **リセット**: フィルターをすべて解除して全データ表示

**初期状態**: 全データを表示、ドロップダウンは「直近 24 時間」に設定

## 📁 プロジェクト構成

```
among-us-log-viewer/
├── index.html              # HTMLマークアップ
├── style.css               # CSSスタイル（ダークテーマ）
├── script.js               # JavaScriptロジック
├── start-server.bat        # サーバー起動スクリプト（推奨）
├── game_history.jsonl      # ゲームログファイル
└── README.md               # このファイル
```

## 📊 game_history.jsonl フォーマット

JSONLines 形式のログファイルです。各行が 1 つのゲーム記録です：

```json
{
    "game_id": "20251114054545_00001_101d87bbe10748ef9df",
    "start_time": "2025-11-14T05:45:45.2993708Z",
    "end_time": "2025-11-14T05:46:09.0596115Z",
    "game_mode": "Standard",
    "map_name": "Skeld",
    "player_count": 2,
    "impostor_count": 1,
    "winner_team": "Jackal",
    "players": [
        {
            "player_id": 0,
            "player_name": "プレイヤー名",
            "player_uuid": "識別子",
            "main_role": "Impostor",
            "sub_roles": [],
            "is_dead": true,
            "death_reason": "Kill",
            "color_id": 0,
            "platform": "PC",
            "tasks_completed": 0,
            "tasks_total": 0,
            "is_winner": false
        }
    ],
    "game_settings": {
        /* ... */
    },
    "game_end_info": {
        /* ... */
    }
}
```

## 🔧 技術スタック

-   **HTML5** - マークアップ（index.html）
-   **CSS3** - スタイリング（style.css、ダークテーマ）
-   **Vanilla JavaScript** - ロジック（script.js、フレームワーク不要）
-   **Chart.js** - グラフ描画（CDN）
-   **Bootstrap 5** - レスポンシブレイアウト（CDN）

## 📱 ブラウザ互換性

-   ✅ Chrome/Chromium（推奨）
-   ✅ Firefox
-   ✅ Safari
-   ✅ Edge
-   ✅ Mobile Browser

## 🛠️ 開発・拡張方法

### ファイル構成の利点

各ファイルが独立しているため、容易に拡張できます：

```javascript
// script.js に新しい機能を追加
function myNewFeature() {
    // 新機能をここに実装
}
```

```css
/* style.css に新しいスタイルを追加 */
.my-new-class {
    color: var(--secondary-color);
}
```

### ローカル開発

```bash
# ローカルサーバーで実行（オプション）
python -m http.server 8000
# またはNode.jsの場合
npx http-server
```

その後 `http://localhost:8000` でアクセス

## ⚙️ トラブルシューティング

### ファイルが読み込めない場合

-   `.jsonl` ファイルか確認してください
-   JSON フォーマットが正しいか確認してください
-   ブラウザの開発者ツール（F12）のコンソールでエラーを確認

### グラフが表示されない場合

-   ブラウザをリロード（Ctrl+R または ⌘+R）
-   JavaScript が有効か確認
-   CDN（Chart.js、Bootstrap）に接続できるか確認

## 🎯 今後の拡張予定

-   [ ] CSV エクスポート機能
-   [ ] プレイヤー間の対戦成績分析
-   [ ] ダークモード/ライトモード切り替え
-   [ ] ローカルストレージでデータをキャッシュ

## 📝 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 🤝 開発者

Among Us ゲーム履歴ビューワー

---

**バージョン**: v1.4  
**最終更新**: 2025 年 11 月 14 日

### v1.4 変更内容（UIレイアウト整理）

#### タブナビゲーションの整理

-   ✅ 時系列タブを削除（ランキング機能で十分）
-   ✅ ランキングタブを削除し、概要タブと統合
-   ✅ 概要タブにランキング機能を統合
    - 勝利数ランキング（円グラフ付き）
    - 勝率ランキング（円グラフ付き、3ゲーム以上）

#### ロール別勝率分析の改善

-   ✅ 棒グラフから円グラフ（ドーナツ型）に変更
-   ✅ ロール名と成績を凡例に表示：`ロール名 (勝利数/ゲーム数)`
-   ✅ ホバーで勝率を表示：「ロール名: 勝率 ●●%」
-   ✅ Impostor（赤）、Crewmate（緑）、その他（シアン）の色分け

#### テーブルヘッダーの明記

-   ✅ ゲーム一覧の「時刻」を「開始時刻」に変更して明確化

#### 不要な関数の削除

-   🔧 `renderWinRateChart()` 関数を削除（概要タブ削除に伴う）
-   🔧 `renderMapStatsChart()` 関数を削除（概要タブ削除に伴う）

#### タブ構成の最終版

| タブ              | 説明                           |
| ----------------- | ------------------------------ |
| 📊 概要           | 勝利数と勝率のランキング       |
| 🎮 プレイヤー統計 | 全プレイヤーの詳細成績表       |
| 🎯 ロール分析     | ロール別勝率（円グラフ）       |
| 📋 ゲーム一覧     | 全ゲームのログ表               |

### v1.3 変更内容（グラフ表示改善）

#### グラフラベル・軸ラベルの可視化改善

-   ✅ グラフの凡例色を明るく変更（グレー → 白）
-   ✅ グラフの軸ラベル色を明るく変更（グレー → 薄いグレー）
-   ✅ すべてのチャートで統一（プレイヤー勝率、マップ統計、時系列、ロール分析）
-   ✅ ランキング円グラフの凡例も白に統一

#### ランキング機能の改善

-   ✅ ランキングに円グラフを追加（勝利数ランキング、勝率ランキング）
-   ✅ 円グラフにホバー表示機能
    -   勝利数ランキング：「プレイヤー名: 勝利数 (割合%)」
    -   勝率ランキング：「プレイヤー名: 勝率 ●●%」
-   ✅ ランキングリスト内の名前をシアン色で強調表示
-   ✅ ランキングリストに左ボーダーを追加

#### キャンバス ID 問題の解決

-   🔧 重複していた canvas ID を修正（winsChart → winsRankingChart、winRateChart → winRateRankingChart）
-   🔧 Chart.js ID 管理エラーを完全解決

### v1.2 変更内容

-   ✅ ワンクリック起動スクリプト（start-server.bat）追加
-   ✅ ファイル自動読み込み機能（game_history.jsonl）
-   ✅ 日時フィルター（タイムゾーン対応）
-   ✅ プリセット時間範囲フィルター（3 時間～ 30 日）
-   ✅ ダッシュボード概要を簡潔に（総ゲーム数、プレイヤー数）
-   ✅ ゲーム一覧に役職情報を追加（メインロール＋サブロール、人数表示、表示順統一）
-   🔧 日時処理のバグ修正（UTC/ローカルタイムゾーン対応）
-   🔧 不要な統計情報を削除（総勝利数、全体勝率）

#### v1.1 変更内容

-   ✅ ファイル分割（HTML/CSS/JS）
-   ✅ MOD 対応（カスタムロール自動検出）
-   ✅ ロール別勝率分析
